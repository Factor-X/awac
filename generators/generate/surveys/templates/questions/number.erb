<%
   d = default
   i = default
   if d == nil or d.strip.length == 0
       d = 'null'
       i = 'null'
   end
   if d.strip != 'null'
       d = "(double) #{default}"
   end
%>

IntegerQuestion <%= accronym.downcase %> = (IntegerQuestion) questionService.findByCode(QuestionCode.<%= accronym %>);
if (<%= accronym.downcase %> == null) {
    <%= accronym.downcase %> = new IntegerQuestion(<%= parent %>, 0, QuestionCode.<%= accronym %>, <%= i %>);
    JPA.em().persist(<%= accronym.downcase %>);
} else {
    if (!<%= accronym.downcase %>.getQuestionSet().equals(<%= parent %>) && <%= parent %>.getQuestions().contains(<%= accronym.downcase %>)) {
        <%= parent %>.getQuestions().remove(<%= accronym.downcase %>);
        JPA.em().persist(<%= parent %>);
    }
    if (<%= accronym.downcase %>.getQuestionSet().equals(<%= parent %>) && !<%= parent %>.getQuestions().contains(<%= accronym.downcase %>)) {
        <%= parent %>.getQuestions().add(<%= accronym.downcase %>);
        JPA.em().persist(<%= parent %>);
    }
    <%= accronym.downcase %>.setOrderIndex(0);
    <%= accronym.downcase %>.setUnitCategory(null);
    JPA.em().persist(<%= accronym.downcase %>);
}
